import{f as e}from"./vendor.15b31224.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(o){const n=new URL(e,location),t=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((o,c)=>{const l=new URL(e,n);if(self[a].moduleMap[l])return o(self[a].moduleMap[l]);const s=new Blob([`import * as m from '${l}';`,`${a}.moduleMap['${l}']=m;`],{type:"text/javascript"}),d=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(s),onerror(){c(new Error(`Failed to import: ${e}`)),t(d)},onload(){o(self[a].moduleMap[l]),t(d)}});document.head.appendChild(d)})),self[a].moduleMap={}}}("/assets/");const a=io("http://localhost:5000/"),o={apiKey:"AIzaSyAT8-lwq5e5nAjOKgAYb7JAH-fix4AayQ4",authDomain:"sumi-c34f3.firebaseapp.com",projectId:"sumi-c34f3",storageBucket:"sumi-c34f3.firebasestorage.app",messagingSenderId:"25411878933",appId:"1:25411878933:web:e982f93c57771fd0388e1c"};e.apps.length||e.initializeApp(o);const n=e.firestore(),t=new RTCPeerConnection({iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10});let c=null,l=null;const s=document.getElementById("share"),d=document.getElementById("sendMessage"),r=document.getElementById("cancelCall"),i=document.getElementById("cancelVideo"),u=document.getElementById("cancelMic"),g=document.getElementById("enableVideo"),y=document.getElementById("enableMic"),m=document.getElementById("loader");var C=!0,p=!0,f=!1,h=!1;const w=document.querySelector("#select_language"),v=document.querySelector("#select_dialect"),I=document.getElementById("webcamVideo"),D=document.getElementById("remoteVideo");var S,R,E=[{language:"Afrikaans",countryCodes:[{langCode:"af-ZA",country:"Default"}]},{language:"Bahasa Indonesia",countryCodes:[{langCode:"id-ID",country:"Default"}]},{language:"Bahasa Melayu",countryCodes:[{langCode:"ms-MY",country:"Default"}]},{language:"Català",countryCodes:[{langCode:"ca-ES",country:"Default"}]},{language:"Czech",countryCodes:[{langCode:"cs-CZ",country:"Default"}]},{language:"Dansk",countryCodes:[{langCode:"da-DK",country:"Default"}]},{language:"Deutsch",countryCodes:[{langCode:"de-DE",country:"Default"}]},{language:"English",countryCodes:[{langCode:"en-AU",country:"Australia"},{langCode:"en-CA",country:"Canada"},{langCode:"en-IN",country:"India"},{langCode:"en-NZ",country:"New Zealand"},{langCode:"en-ZA",country:"South Africa"},{langCode:"en-GB",country:"United Kingdom"},{langCode:"en-US",country:"United States"}]},{language:"Español",countryCodes:[{langCode:"es-AR",country:"Argentina"},{langCode:"es-BO",country:"Bolivia"},{langCode:"es-CL",country:"Chile"},{langCode:"es-CO",country:"Colombia"},{langCode:"es-CR",country:"Costa Rica"},{langCode:"es-EC",country:"Ecuador"},{langCode:"es-SV",country:"El Salvador"},{langCode:"es-ES",country:"España"},{langCode:"es-US",country:"Estados Unidos"},{langCode:"es-GT",country:"Guatemala"},{langCode:"es-HN",country:"Honduras"},{langCode:"es-MX",country:"México"},{langCode:"es-NI",country:"Nicaragua"},{langCode:"es-PA",country:"Panamá"},{langCode:"es-PY",country:"Paraguay"},{langCode:"es-PE",country:"Perú"},{langCode:"es-PR",country:"Puerto Rico"},{langCode:"es-DO",country:"República Dominicana"},{langCode:"es-UY",country:"Uruguay"},{langCode:"es-VE",country:"Venezuela"}]},{language:"Euskara",countryCodes:[{langCode:"eu-ES",country:"Default"}]},{language:"Filipino",countryCodes:[{langCode:"fil-PH",country:"Default"}]},{language:"Français",countryCodes:[{langCode:"fr-FR",country:"Default"}]},{language:"Galego",countryCodes:[{langCode:"gl-ES",country:"Default"}]},{language:"Hrvatski",countryCodes:[{langCode:"hr_HR",country:"Default"}]},{language:"IsiZulu",countryCodes:[{langCode:"zu-ZA",country:"Default"}]},{language:"Íslenska",countryCodes:[{langCode:"is-IS",country:"Default"}]},{language:"Italiano",countryCodes:[{langCode:"it-IT",country:"Italia"},{langCode:"it-CH",country:"Svizzera"}]},{language:"Lithuanian",countryCodes:[{langCode:"lt-LT",country:"Default"}]},{language:"Magyar",countryCodes:[{langCode:"hu-HU",country:"Default"}]},{language:"Nederlands",countryCodes:[{langCode:"nl-NL",country:"Default"}]},{language:"Norsk bokmål",countryCodes:[{langCode:"nb-NO",country:"Default"}]},{language:"Polski",countryCodes:[{langCode:"pl-PL",country:"Default"}]},{language:"Português",countryCodes:[{langCode:"pt-BR",country:"Brasil"},{langCode:"pt-PT",country:"Portugal"}]},{language:"Romanian",countryCodes:[{langCode:"ro-RO",country:"Default"}]},{language:"Slovenian",countryCodes:[{langCode:"sl-SI",country:"Default"}]},{language:"Slovak",countryCodes:[{langCode:"sk-SK",country:"Default"}]},{language:"Suomi",countryCodes:[{langCode:"fi-FI",country:"Default"}]},{language:"Svenska",countryCodes:[{langCode:"sv-SE",country:"Default"}]},{language:"Vietnamese",countryCodes:[{langCode:"vi-VN",country:"Default"}]},{language:"Turkish",countryCodes:[{langCode:"tr-TR",country:"Default"}]},{language:"Greek",countryCodes:[{langCode:"el-GR",country:"Default"}]},{language:"Bulgarian",countryCodes:[{langCode:"bg-BG",country:"Default"}]},{language:"Russian",countryCodes:[{langCode:"ru-RU",country:"Default"}]},{language:"Ukrainian",countryCodes:[{langCode:"uk-UA",country:"Default"}]},{language:"Korean",countryCodes:[{langCode:"ko-KR",country:"Default"}]},{language:"Japanese",countryCodes:[{langCode:"ja-JP",country:"Default"}]},{language:"Hindi",countryCodes:[{langCode:"hi-IN",country:"Default"}]},{language:"Thai",countryCodes:[{langCode:"th-TH",country:"Default"}]}];const k=document.getElementById("savelanguage"),b=async()=>{const e=n.collection("calls").doc(),a=e.collection("offerCandidates"),o=e.collection("answerCandidates");t.onicecandidate=e=>{e.candidate&&a.add(e.candidate.toJSON())};const c=await t.createOffer();await t.setLocalDescription(c);const l={sdp:c.sdp,type:c.type};await e.set({offer:l}),e.onSnapshot((e=>{const a=e.data();if(!t.currentRemoteDescription&&(null==a?void 0:a.answer)){const e=new RTCSessionDescription(a.answer);t.setRemoteDescription(e)}})),o.onSnapshot((e=>{e.docChanges().forEach((e=>{if("added"===e.type){const a=new RTCIceCandidate(e.doc.data());t.addIceCandidate(a)}}))})),localStorage.setItem("callId",e.id),await T(e.id),document.getElementById("createCall").classList.toggle("dontshow"),document.getElementById("stablishCall").classList.toggle("dontshow"),R=e.id},B=async()=>{p=!!h,C=!!f,await M(),console.log(C,p),c=await navigator.mediaDevices.getUserMedia({video:C,audio:p}),l=new MediaStream,c.getTracks().forEach((e=>{t.addTrack(e,c)})),t.ontrack=e=>{e.streams[0].getTracks().forEach((e=>{l.addTrack(e)}))},I.srcObject=c,D.srcObject=l},O=async e=>{const o=e,c=n.collection("calls").doc(o),l=c.collection("answerCandidates"),s=c.collection("offerCandidates");t.onicecandidate=e=>{e.candidate&&l.add(e.candidate.toJSON())};const d=(await c.get()).data().offer;await t.setRemoteDescription(new RTCSessionDescription(d));const r=await t.createAnswer();await t.setLocalDescription(r);const i={type:r.type,sdp:r.sdp};await c.update({answer:i}),s.onSnapshot((e=>{e.docChanges().forEach((e=>{if(console.log(e),"added"===e.type){let a=e.doc.data();t.addIceCandidate(new RTCIceCandidate(a))}}))})),document.getElementById("createCall").classList.toggle("dontshow"),document.getElementById("stablishCall").classList.toggle("dontshow"),a.emit("registermylanguage",{lang:document.querySelector("#select_dialect").value,roomId:R})},T=async e=>{a.emit("room",e)},A=async()=>{for(var e=v.options.length-1;e>=0;e--)v.remove(e);E[w.selectedIndex].countryCodes.map((e=>{v.options.add(new Option(e.country,e.langCode))}))},M=async()=>{navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?navigator.mediaDevices.enumerateDevices().then((e=>{e.forEach((function(e){"audiooutput"==e.kind&&(h=!0),"videoinput"==e.kind&&(f=!0)}))})).catch((e=>{toastr.error("No tienes dispositivos para la llamada")})):toastr.error("No tienes dispositivos para la llamada")};async function P(){if("webkitSpeechRecognition"in window)if(window.hasOwnProperty("webkitSpeechRecognition"))if("function"==typeof webkitSpeechRecognition){(S=new webkitSpeechRecognition).continuous=!0,S.interimResults=!0,S.lang=document.querySelector("#select_dialect").value;var e=1,o="";S.onspeechend=function(a){e=0,S.stop()},S.onend=function(){0==e&&S.start()},S.onresult=n=>{for(let r=n.resultIndex;r<n.results.length;++r){var t=n.results[r][0].transcript;if(console.log(n.results[r]),n.results[r].isFinal){var c=new Date,l=c.getHours()+":"+c.getMinutes(),s=localStorage.getItem("langfrom"),d={time:l,msg:t.trim(),lang:document.querySelector("#select_dialect").value,langfrom:s};a.emit("sendmessage",{data:d,roomId:R}),o='<div class="me"><div class="msg">'+d.msg+'</div><div class="hour">'+d.time+"</div></div>",$("#chat").append(o),$("#chat").animate({scrollTop:$("#chat").prop("scrollHeight")},1e3),e=0,S.stop()}}},S.start(),m.hidden=!0}else await toastr.error("Unable to use the Speech Recognition API");else await toastr.error("Unable to use the Speech Recognition API");else await toastr.error("Unable to use the Speech Recognition API")}s.onclick=async()=>{var e=localStorage.getItem("callId"),a=window.location.href+"?"+e;document.getElementsByTagName("body")[0].focus(),navigator.clipboard?(await navigator.clipboard.writeText(a),toastr.success("Copiado!")):toastr.warning("error")},d.onclick=async()=>{var e=$("#textmsg").val().trim(),o=new Date,n=o.getHours()+":"+o.getMinutes(),t={time:n,msg:e},c='<div class="me"><div class="msg">'+e+'</div><div class="hour">'+n+"</div></div>";$("#chat").append(c),$("#textmsg").val(""),a.emit("sendmessage",{data:t,roomId:R}),$("#chat").animate({scrollTop:$("#chat").prop("scrollHeight")},1e3)},w.onchange=async()=>{await A()},k.onclick=async()=>{m.hidden=!1,await(async()=>{var e=window.location.href;if((e=e.split("?")).length>1){var a=(e=e.pop()).split("=").pop();return R=a,await B(),await O(a),await T(a),void(await P())}await B(),await b(),await P()})()},r.onclick=async()=>{var e=window.location.href;if((e=e.split("?")).length>1){var a=window.location.href.split("?")[0];window.location.href=a}else;},i.onclick=async()=>{a.emit("turnOffRemoteCamera",{roomId:R}),I.hidden=!0,i.hidden=!0,g.hidden=!1},g.onclick=async()=>{a.emit("turnOnRemoteCamera",{roomId:R}),I.hidden=!1,i.hidden=!1,g.hidden=!0},u.onclick=async()=>{a.emit("turnOffRemoteCMic",{roomId:R}),u.hidden=!0,y.hidden=!1,S.stop()},y.onclick=async()=>{a.emit("turnOnRemoteCMic",{roomId:R}),u.hidden=!1,y.hidden=!0,S.start()},a.on("receiveMessage",(async e=>{await(async e=>{var a='<div class="other"><div class="msg">'+e.msg+'</div><div class="hour">'+e.time+"</div></div>";$("#chat").append(a),$("#chatmobile").append(a),$("#chat").animate({scrollTop:$("#chat").prop("scrollHeight")},1e3),$("#chatmobile").animate({scrollTop:$("#chat").prop("scrollHeight")},1e3)})(e)})),a.on("receiveLanguage",(e=>{localStorage.setItem("langfrom",e),a.emit("emitmylang",{lang:document.querySelector("#select_dialect").value,roomId:R})})),a.on("receivenewlang",(e=>{localStorage.setItem("langfrom",e)})),a.on("turnOffRemoteCMic",(()=>{D.muted=!0})),a.on("turnOnRemoteMic",(()=>{D.muted=!1})),a.on("turnOffRemoteCamera",(()=>{D.hidden=!0})),a.on("turnOnRemoteCamera",(()=>{D.hidden=!1})),$(document).ready((async()=>{await(async()=>{for(var e=0;e<E.length;e++){var a=E[e];w.options[e]=new Option(a.language,e)}w.selectedIndex=6,await A(),v.selectedIndex=0})(),await M()}));
